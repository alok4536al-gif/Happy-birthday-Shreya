<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cinematic Wormhole Intro</title>
<style>
html,body{
  margin:0;padding:0;
  height:100%;width:100%;
  overflow:hidden;
  background:#000;
  font-family:'Segoe UI',sans-serif;
  color:#fff;
  text-align:center;
}
#typingBox{
  position:absolute;
  top:30%;
  left:50%;
  transform:translateX(-50%);
}
.line{
  font-size:2.2rem;
  margin:15px 0;
  white-space:nowrap;
  border-right:2px solid #fff;
  display:inline-block;
}
#fadeOut{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:#000;
  opacity:0;
  pointer-events:none;
  transition:opacity 3s ease-in-out;
}
canvas{display:block;}
</style>
</head>
<body>

<div id="typingBox">
  <div class="line" id="line1"></div>
  <div class="line" id="line2"></div>
  <div class="line" id="line3"></div>
</div>

<div id="fadeOut"></div>
<audio id="introAudio" src="intro.mp3"></audio>

<!-- Three.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
/* ---------- Typing Intro ---------- */
const lines = [
  "Itâ€™s time to",
  "board the train",
  "of memories"
];
const ids = ["line1","line2","line3"];
let currentLine = 0, charIndex = 0;

function playAudio(){
  const audio = document.getElementById('introAudio');
  audio.play().catch(()=>{
    document.body.addEventListener('click',()=>audio.play(),{once:true});
  });
}

function typeLine(){
  if(currentLine < lines.length){
    const el = document.getElementById(ids[currentLine]);
    if(charIndex < lines[currentLine].length){
      el.textContent += lines[currentLine].charAt(charIndex);
      charIndex++;
      setTimeout(typeLine,100);
    }else{
      el.style.borderRight='none';
      currentLine++; charIndex=0;
      setTimeout(typeLine,800);
    }
  }else{
    setTimeout(startTunnel,1500);
  }
}
typeLine();

/* ---------- Three.js Wormhole ---------- */
let scene,camera,renderer,mesh,clock;
function startTunnel(){
  playAudio();
  document.getElementById('typingBox').style.display='none';

  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
  renderer = new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth,window.innerHeight);
  document.body.appendChild(renderer.domElement);

  const geometry = new THREE.CylinderGeometry(20,20,400,32,1,true);
  const material = new THREE.MeshBasicMaterial({
    side:THREE.BackSide,
    map:new THREE.TextureLoader().load('photo11.jpg')
  });
  mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh);

  camera.position.z = 0;
  camera.rotation.x = Math.PI/2;

  clock = new THREE.Clock();
  animate();

  // fade out and redirect
  setTimeout(()=>{
    document.getElementById('fadeOut').style.opacity='1';
    setTimeout(()=>window.location.href='memories.html',3000);
  },20000); // ~20 sec travel
}

function animate(){
  requestAnimationFrame(animate);
  const t = clock.getElapsedTime();
  mesh.position.y = -t*20;    // move texture to simulate travel
  mesh.rotation.z += 0.001*t; // slight twist
  renderer.render(scene,camera);
}

window.addEventListener('resize',()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>

</body>
</html>
